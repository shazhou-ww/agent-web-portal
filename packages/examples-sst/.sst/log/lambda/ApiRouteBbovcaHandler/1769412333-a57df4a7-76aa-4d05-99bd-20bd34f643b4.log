invocation a57df4a7-76aa-4d05-99bd-20bd34f643b4
{"version":"2.0","routeKey":"$default","rawPath":"/auth/page","rawQueryString":"pubkey=vK7Vb777Ktjiw5GmQZ1IuSysLgw7d9GhFB-qb1jUnjo.Q829htuSwEgSgy0rjPpzw4dPe9H5LKo0Ua78Pv_ql84&code=5YF-ZBP","headers":{"accept":"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-encoding":"gzip, deflate, br, zstd","accept-language":"en,en-US;q=0.9,zh-CN;q=0.8,zh;q=0.7","content-length":"0","host":"ez8egiyr47.execute-api.us-east-1.amazonaws.com","priority":"u=0, i","referer":"http://localhost:5173/","sec-ch-ua":"\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Microsoft Edge\";v=\"144\"","sec-ch-ua-mobile":"?0","sec-ch-ua-platform":"\"Windows\"","sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"cross-site","sec-fetch-user":"?1","upgrade-insecure-requests":"1","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36 Edg/144.0.0.0","x-amzn-trace-id":"Root=1-697716ea-1c8807612141d9242b94e777","x-forwarded-for":"167.220.255.14","x-forwarded-port":"443","x-forwarded-proto":"https"},"queryStringParameters":{"code":"5YF-ZBP","pubkey":"vK7Vb777Ktjiw5GmQZ1IuSysLgw7d9GhFB-qb1jUnjo.Q829htuSwEgSgy0rjPpzw4dPe9H5LKo0Ua78Pv_ql84"},"requestContext":{"accountId":"914369185440","apiId":"ez8egiyr47","domainName":"ez8egiyr47.execute-api.us-east-1.amazonaws.com","domainPrefix":"ez8egiyr47","http":{"method":"GET","path":"/auth/page","protocol":"HTTP/1.1","sourceIp":"167.220.255.14","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36 Edg/144.0.0.0"},"requestId":"XyCEwg16oAMEMZw=","routeKey":"$default","stage":"$default","time":"26/Jan/2026:07:25:30 +0000","timeEpoch":1769412330874},"isBase64Encoded":false}
response a57df4a7-76aa-4d05-99bd-20bd34f643b4
{"statusCode":200,"headers":{"Content-Type":"text/html; charset=utf-8"},"body":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Authorize AWP UI Test</title>\n  <style>\n    * { box-sizing: border-box; margin: 0; padding: 0; }\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      min-height: 100vh;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 20px;\n    }\n    .container {\n      background: white;\n      border-radius: 16px;\n      box-shadow: 0 20px 60px rgba(0,0,0,0.3);\n      padding: 40px;\n      width: 100%;\n      max-width: 450px;\n    }\n    h1 {\n      color: #333;\n      font-size: 24px;\n      margin-bottom: 8px;\n      text-align: center;\n    }\n    .subtitle {\n      color: #666;\n      font-size: 14px;\n      text-align: center;\n      margin-bottom: 30px;\n    }\n    .client-info {\n      background: #f8f9ff;\n      border: 1px solid #e0e4ff;\n      border-radius: 12px;\n      padding: 20px;\n      margin-bottom: 24px;\n      text-align: center;\n    }\n    .client-name {\n      font-size: 20px;\n      font-weight: 600;\n      color: #333;\n      margin-bottom: 8px;\n    }\n    .client-label {\n      font-size: 12px;\n      color: #666;\n      text-transform: uppercase;\n      letter-spacing: 1px;\n    }\n    .verification-code {\n      background: #f0f4ff;\n      border: 2px dashed #667eea;\n      border-radius: 8px;\n      padding: 16px;\n      text-align: center;\n      margin-bottom: 24px;\n    }\n    .verification-code label {\n      display: block;\n      color: #666;\n      font-size: 12px;\n      margin-bottom: 8px;\n    }\n    .verification-code .code {\n      font-family: 'SF Mono', Monaco, monospace;\n      font-size: 28px;\n      font-weight: bold;\n      color: #667eea;\n      letter-spacing: 4px;\n    }\n    .verification-code .hint {\n      font-size: 12px;\n      color: #888;\n      margin-top: 8px;\n    }\n    .form-group {\n      margin-bottom: 20px;\n    }\n    label {\n      display: block;\n      color: #333;\n      font-size: 14px;\n      font-weight: 500;\n      margin-bottom: 6px;\n    }\n    select {\n      width: 100%;\n      padding: 12px 16px;\n      border: 2px solid #e0e0e0;\n      border-radius: 8px;\n      font-size: 16px;\n      background: white;\n      cursor: pointer;\n    }\n    select:focus {\n      outline: none;\n      border-color: #667eea;\n    }\n    .buttons {\n      display: flex;\n      gap: 12px;\n    }\n    button {\n      flex: 1;\n      padding: 14px;\n      border: none;\n      border-radius: 8px;\n      font-size: 16px;\n      font-weight: 600;\n      cursor: pointer;\n      transition: transform 0.2s, box-shadow 0.2s;\n    }\n    button.primary {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: white;\n    }\n    button.primary:hover {\n      transform: translateY(-2px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\n    }\n    button.secondary {\n      background: #f5f5f5;\n      color: #666;\n    }\n    button.secondary:hover {\n      background: #eee;\n    }\n    .error {\n      background: #fff0f0;\n      border: 1px solid #ffcdd2;\n      color: #c62828;\n      padding: 12px;\n      border-radius: 8px;\n      margin-bottom: 20px;\n      font-size: 14px;\n    }\n    .warning {\n      background: #fff8e1;\n      border: 1px solid #ffe082;\n      color: #f57c00;\n      padding: 12px;\n      border-radius: 8px;\n      margin-top: 20px;\n      font-size: 13px;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <h1>Authorize Application</h1>\n    <p class=\"subtitle\">A client is requesting access to your account</p>\n    \n    <div class=\"client-info\">\n      <div class=\"client-label\">Client Name</div>\n      <div class=\"client-name\">AWP UI Test</div>\n    </div>\n    \n    <div class=\"verification-code\">\n      <label>Verification Code</label>\n      <div class=\"code\">5YF-ZBP</div>\n      <div class=\"hint\">Verify this code matches what your client is showing</div>\n    </div>\n    \n    \n    \n    <form id=\"auth-form\">\n      <input type=\"hidden\" id=\"pubkey\" value=\"\">\n      <input type=\"hidden\" id=\"verification_code\" value=\"5YF-ZBP\">\n      \n      <div class=\"form-group\">\n        <label for=\"expires_in\">Authorization Duration</label>\n        <select id=\"expires_in\" name=\"expires_in\">\n          <option value=\"86400\">1 day</option>\n          <option value=\"604800\">7 days</option>\n          <option value=\"2592000\" selected>30 days</option>\n          <option value=\"7776000\">90 days</option>\n          <option value=\"\">Never expires</option>\n        </select>\n      </div>\n      \n      <div class=\"buttons\">\n        <button type=\"button\" class=\"secondary\" onclick=\"window.close()\">Deny</button>\n        <button type=\"submit\" class=\"primary\">Authorize</button>\n      </div>\n    </form>\n    \n    <div class=\"warning\">\n      ⚠️ Only authorize applications you trust. This client will be able to access tools on your behalf.\n    </div>\n  </div>\n  \n  <script>\n    // Parse URL parameters\n    const params = new URLSearchParams(window.location.search);\n    const pubkey = params.get('pubkey') || '';\n    document.getElementById('pubkey').value = pubkey;\n    \n    // Handle form submission\n    document.getElementById('auth-form').addEventListener('submit', async (e) => {\n      e.preventDefault();\n      \n      const expiresInValue = document.getElementById('expires_in').value;\n      const body = {\n        pubkey: document.getElementById('pubkey').value,\n        verification_code: document.getElementById('verification_code').value,\n      };\n      if (expiresInValue) {\n        body.expires_in = parseInt(expiresInValue, 10);\n      }\n      \n      try {\n        const response = await fetch('/auth/complete', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(body),\n        });\n        \n        if (response.ok) {\n          window.location.href = '/auth/success';\n        } else {\n          const data = await response.json();\n          alert(data.error_description || 'Authorization failed');\n        }\n      } catch (err) {\n        alert('Network error. Please try again.');\n      }\n    });\n  </script>\n</body>\n</html>"}
